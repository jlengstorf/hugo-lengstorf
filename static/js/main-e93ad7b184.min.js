"use strict";function HighlightShare(e){var t=e||{},n=t.classNames||{},i=this.config={url:t.url||window.location.href,hashtags:t.hashtags||"",related:t.related||"jlengstorf",via:t.via||"",classNames:{wrapper:n.wrapper||"highlight-share__share-box",active:n.active||"highlight-share__is-active",tweetBtn:n.tweetBtn||"highlight-share__share-btn--twitter"},container:t.container||"body",appendTo:"body"},o=document.createElement("div"),a=document.createElement("button");this.savedText=!1,this.isActive=!1,a.className=i.classNames.tweetBtn,o.className=i.classNames.wrapper,o.appendChild(a),o.addEventListener("click",this.handleButtonClick.bind(this)),this.container=document.querySelector(this.config.container),document.querySelector(i.appendTo).appendChild(o),document.addEventListener("mouseup",this.handleSelection.bind(this))}!function(){var e=document.querySelectorAll(".five-stages");e&&!function(){var t=function(e,t){return function(){n(e)?e.classList.add("js__in-viewport"):e.classList.remove("js__in-viewport")}},n=function(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)};[].forEach.call(e,function(e){e.classList.add("js__active");var n=t(e);addEventListener("scroll",n,!1)})}()}(),HighlightShare.prototype=Object.create({constructor:{value:HighlightShare}}),HighlightShare.prototype.getSelectedText=function(){if(window.getSelection){var e=window.getSelection();if(e.getRangeAt&&e.rangeCount)return e.getRangeAt(0)}else if(document.selection&&document.selection.createRange)return document.selection.createRange();return!1},HighlightShare.prototype.restoreSelectedText=function(e){if(e)if(window.getSelection){var t=window.getSelection();t.removeAllRanges(),t.addRange(e)}else document.selection&&e.select&&e.select()},HighlightShare.prototype.handleSelection=function(e){this.savedText=this.getSelectedText(),this.isInContainer(e.target)&&setTimeout(this.showSharingBox.bind(this),100,e)},HighlightShare.prototype.showSharingBox=function(e){var t=0===this.savedText.toString().length,n=this.getWrapper(),i=["a","img","button","input","select"],o=e.target.tagName.toLowerCase();t||this.isActive||-1!==i.indexOf(o)?this.hideSharingBox():(this.isActive=!0,n.style.left=e.pageX+"px",n.style.top=e.pageY+"px",n.className+=" "+this.config.classNames.active)},HighlightShare.prototype.handleButtonClick=function(e){this.savedText&&(-1!==e.target.className.indexOf(this.config.classNames.tweetBtn)&&window.open(this.buildTwitterUrl(),"sharing-window","width=600, height=400, top=200, left=300"),this.restoreSelectedText(this.savedText))},HighlightShare.prototype.hideSharingBox=function(){var e=this.getWrapper(),t=e.className.replace(this.config.classNames.active,"");e.style.left="",e.style.top="",e.className=t,this.isActive=!1},HighlightShare.prototype.buildTwitterUrl=function(){var e="https://twitter.com/intent/tweet",t={text:this.savedText,url:this.config.url||"",hashtags:this.config.hashtags||"",related:this.config.related||"",via:this.config.via||""},n="";for(var i in t)t[i].toString().length>0&&(n+=0===n.length?"?":"&",n+=i+"="+t[i]);return e+n},HighlightShare.prototype.getWrapper=function(){return document.getElementsByClassName(this.config.classNames.wrapper)[0]},HighlightShare.prototype.isInContainer=function(e){return null===this.container?!1:this.container===e?!1:this.container.contains(e)},function(){function e(e,t,n){return new Promise(function(i,o){var a=e.scrollTop,r=t-a,s=20,c=function(e,t,n,i){return e/=i/2,1>e?n/2*e*e+t:(e--,-n/2*(e*(e-2)-1)+t)},l=function d(t){t+=s;var o=c(t,a,r,n);e.scrollTop=o,n>t?setTimeout(function(){d(t)},s):i()};l(0)})}function t(){return document.body.scrollTop?document.body:document.documentElement}function n(n,a){return new Promise(function(r,s){if(!C){C=!0;var c=n.split("#")[1]||!1,l=document.location,d=l.protocol+"//"+l.host+l.pathname;if(!n.replace(d,"").match(/^http/)&&c){a.preventDefault();var h=document.getElementById(c),u="mobile"===o?60:70,g=h.offsetTop-u;i(h),h.offsetParent.classList.contains("post-footnotes")&&(g+=h.offsetParent.offsetTop+30);var m=t();e(m,g,750).then(function(){C=!1,r()})}}})}function i(e){for(var t=e.offsetParent,n=t.classList.contains("post-footnotes"),i=document.querySelector(".post-footnotes__list"),o=i?i.firstElementChild:!1;o&&"LI"===o.tagName;)o.classList.remove("add-highlight"),o=o.nextElementSibling,console.log(o);n&&"LI"===e.tagName&&e.classList.add("add-highlight")}var o=window.getComputedStyle(document.body,":after").getPropertyValue("content").replace(/\W/g,"");"ontouchstart"in window&&"msmaxtouchpoints"in window.navigator||document.body.classList.add("js__not-touch");var a=Date.now(),r=new Date("2014-12-30T12:00:00"),s=Math.ceil((a-r)/864e5),c=document.querySelector(".days-abroad");if(c&&(c.textContent=s+" days"),"desktop"===o)for(var l=document.querySelectorAll(".main-content__sharing"),d=function(e){e.target.classList.contains("main-content__sharing-link")&&(e.preventDefault(),window.open(e.target.href,"sharing-window","width=800, height=400, top=200, left=300"))},h=0;h<l.length;h++)l[h].addEventListener("click",d);if(o.length)for(var u=[".main-content__headline",".main-content__headline--related",".main-content__headline--single"].join(","),g=document.querySelectorAll(u),m=void 0,f=void 0,h=0;h<g.length;h++)m=g[h],f=m.dataset.image,m.style.backgroundImage="url("+f+")",m.classList.add("show-image");if("desktop"===o){var p=[".main-content__headline",".main-content__headline--single",".main-content__headline--page"].join(","),v=document.querySelectorAll(p);if(v.length>0){var w=v[0],y=w.dataset.image,S=document.querySelector("body"),_=window.getComputedStyle(S).backgroundColor,b=void 0;b=-1===_.indexOf("rgba")?_.replace(")",", 0.92)").replace("rgb","rgba"):_;var L="linear-gradient(to bottom, "+b+", "+_+" 50vw)";S.style.backgroundImage=L+", url("+y+")"}}if("desktop"!==o){var T=document.querySelector(".site-header"),x=document.querySelector(".site-header__navigation");T.removeChild(x),document.body.appendChild(x)}var C=!1;document.addEventListener("click",function(e){var t=e.target;"a"===t.tagName.toLowerCase()&&"undefined"!==t.href&&!function(){var i=t.href;document.body&&0===document.body.scrollTop&&(document.body.scrollTop=1),n(i,e).then(function(){history.pushState({newURL:i},"",i)})}()}),window.addEventListener("hashchange",function(e){e.preventDefault();var t=e.newURL;n(t)});var N=document.querySelector(".footnotes");if(null!==N){var k=N.getElementsByTagName("OL"),E=document.querySelector(".post-footnotes");k[0].classList.add("post-footnotes__list"),E.appendChild(k[0]),E.classList.remove("hidden"),N.parentNode&&N.parentNode.removeChild(N)}var q=function(e){ga("send","event","outbound","click",e,{hitCallback:function(){document.location=e}})},A=function(e){var t=e.url,n=e.source,i=e.campaign;ga("send",{hitType:"event",eventCategory:i,eventAction:"click",eventLabel:n,hitCallback:function(){document.location=t}})};if(document.addEventListener("click",function(e){if(e.target.classList.contains("js__ga-track-outbound")&&(e.preventDefault(),q(e.target.href)),e.target.classList.contains("js__ga-track-campaign")){e.preventDefault();var t={url:e.target.href,campaign:e.target.dataset.campaign||"default-campaign",source:e.target.dataset.source||document.location.pathname};A(t)}}),o.length){new HighlightShare({via:"jlengstorf",container:".main-content__content"})}}(),function(){var e=document.querySelector(".subnav-toggle");e.addEventListener("click",function(t){t.preventDefault();var n=document.querySelector(".site-header"),i=document.querySelector(".slide-out-nav"),o=void 0;n.classList.contains("closed")?(n.classList.remove("closed"),n.classList.add("open"),i.setAttribute("aria-hidden",!1),o="Less"):(n.classList.remove("open"),i.setAttribute("aria-hidden",""),o="More",setTimeout(function(){n.classList.add("closed"),i.setAttribute("aria-hidden",!0)},500)),e.textContent=o})}();
//# sourceMappingURL=../maps/main-e93ad7b184.min.js.map