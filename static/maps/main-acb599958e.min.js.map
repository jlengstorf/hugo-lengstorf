{"version":3,"sources":["main.js","highlightshare.js","mandrillcontactform.js"],"names":["HighlightShare","options","opts","classes","classNames","config","this","url","window","location","href","hashtags","related","via","wrapper","active","tweetBtn","container","appendTo","shareBox","document","createElement","savedText","isActive","className","appendChild","addEventListener","handleButtonClick","bind","querySelector","handleSelection","prototype","Object","create","constructor","value","getSelectedText","getSelection","selection","getRangeAt","rangeCount","createRange","restoreSelectedText","range","removeAllRanges","addRange","select","event","isInContainer","target","setTimeout","showSharingBox","isEmpty","toString","length","getWrapper","ignoredTags","targetTag","tagName","toLowerCase","indexOf","hideSharingBox","style","left","pageX","top","pageY","open","buildTwitterUrl","updatedClass","replace","properties","text","queryString","prop","getElementsByClassName","node","contains","scrollTo","element","targetPos","duration","currentPos","scrollTop","posChange","increment","console","log","easeInOut","currentTime","start","change","animateScroll","elapsedTime","newPos","size","getComputedStyle","body","getPropertyValue","todayIs","Date","now","iLeftOn","daysSince","Math","ceil","$daysAbroad","textContent","$subnavToggle","preventDefault","$header","navText","undefined","classList","remove","add","$sharing","querySelectorAll","callback","i","selector","join","$headlines","$headline","headlineImage","dataset","image","backgroundImage","bgSelectors","$bgHeadlines","$bgHeadline","bgImage","$body","bgColor","backgroundColor","bgFade","bgGradient","loc","currentURL","protocol","host","pathname","match","menuAdjustment","anchorOffset","offsetTop","$mdFootnotesContainer","$footnotesList","getElementsByTagName","$footnotesContainer","parentNode","removeChild","gaTrackOutboundClick","ga","hitCallback","$contact","getElementById","sendMessage","message","endpointURI","xhr","XMLHttpRequest","messageJSON","JSON","stringify","onload","send","disableForm","form","disabled","enableForm","displayError","msg","$error","$errorMsg","insertBefore","firstChild","removeAllErrors","$errors","map","call","error","validateFields","params","isError","email","fname","lname","comment","afterSubmit","xhrEvent","currentTarget","readyState","status","response","parse","responseText","baseURL","origin","$form","reject_reason","toSend","key","subject","from_email","from_name","to","atob","name","type","filter","elements","el","forEach"],"mappings":"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","file":"main-acb599958e.min.js","sourcesContent":["// Porting the site's functionality away from jQuery\n(() => {\n\n  'use strict';\n\n  /*\n   * SCREEN SIZE DETECTION FOR JS VIA CSS\n   * More info on how this works: http://adactio.com/journal/5429/\n   ***************************************************************************/\n  const size = window.getComputedStyle(document.body, ':after')\n              .getPropertyValue('content').replace(/\\W/g, '');\n\n  /*\n   * CUSTOM THEME JS\n   ***************************************************************************/\n\n  // DAYS ON THE ROAD COUNTER\n  const todayIs = Date.now();\n  const iLeftOn = new Date('2014-12-30T12:00:00');\n\n  // 1000ms x 60s x 60m x 24h\n  const daysSince = Math.ceil((todayIs - iLeftOn) / 86400000);\n  const $daysAbroad = document.querySelector('.days-abroad');\n  if ($daysAbroad) {\n    $daysAbroad.textContent = daysSince + ' days';\n  }\n\n  // SUBNAV TOGGLE\n  // Toggles open/close state of the subnav panel\n  const $subnavToggle = document.querySelector('.subnav-toggle');\n  $subnavToggle.addEventListener('click', (event) => {\n\n    event.preventDefault();\n\n    const $header = document.querySelector('.site-header');\n    let navText;\n\n    if ($header.classList.contains('closed')) {\n      $header.classList.remove('closed');\n      $header.classList.add('open');\n\n      navText = 'Less';\n    } else {\n      $header.classList.remove('open');\n\n      navText = 'More';\n\n      setTimeout(() => { $header.classList.add('closed'); }, 500);\n    }\n\n    $subnavToggle.textContent = navText;\n\n  });\n\n  // SHARING POPUPS\n  if (size === 'desktop') {\n    const $sharing = document.querySelectorAll('.main-content__sharing');\n    const callback = event => {\n\n      // Only targets sharing links\n      if (event.target.classList.contains('main-content__sharing-link')) {\n        event.preventDefault();\n\n        // Opens a small named window for standard sharing\n        window.open(\n          event.target.href,\n          'sharing-window',\n          'width=800, height=400, top=200, left=300'\n        );\n      }\n    };\n\n    // Loops through each matched node and attaches a click handler\n    for (let i = 0; i < $sharing.length; i++) {\n      $sharing[i].addEventListener('click', callback);\n    }\n  }\n\n  // FEATURED IMAGE HANDLING\n  // Mobile featured images are handled differently\n\n  // Adds a class that fires up JS-only styles\n  if (size.length) {\n    const selector = [\n      '.main-content__headline',\n      '.main-content__headline--related',\n      '.main-content__headline--single',\n    ].join(',');\n    const $headlines = document.querySelectorAll(selector);\n    let $headline;\n    let headlineImage;\n\n    for (let i = 0; i < $headlines.length; i++) {\n      $headline = $headlines[i];\n      headlineImage = $headline.dataset.image;\n\n      $headline.style.backgroundImage = 'url(' + headlineImage + ')';\n\n      // Adds a class that causes JS-specific styles to render\n      $headline.classList.add('show-image');\n    }\n  }\n\n  // Attaches the background image to the\n  if (size === 'desktop') {\n    const bgSelectors = [\n      '.main-content__headline',\n      '.main-content__headline--single',\n      '.main-content__headline--page',\n    ].join(',');\n    const $bgHeadlines = document.querySelectorAll(bgSelectors);\n\n    if ($bgHeadlines.length > 0) {\n      const $bgHeadline = $bgHeadlines[0];\n      const bgImage = $bgHeadline.dataset.image;\n\n      // Loads the body style info to access the background color\n      const $body = document.querySelector('body');\n      const bgColor = window.getComputedStyle($body).backgroundColor;\n\n      // Creates a gradient color to use in the style declaration\n      let bgFade;\n      if (bgColor.indexOf('rgba') === -1) {\n        bgFade = bgColor.replace(')', ', 0.92)').replace('rgb', 'rgba');\n      } else {\n        bgFade = bgColor;\n      }\n\n      const bgGradient = 'linear-gradient(to bottom, ' + bgFade + ', ' +\n        bgColor + ' 50vw)';\n\n      $body.style.backgroundImage = bgGradient + ', url(' + bgImage + ')';\n    }\n  }\n\n  // LOCAL SCROLLING (WITHOUT JQUERY)\n  // Adds a function to handle scrolling the page\n  function scrollTo(element, targetPos, duration) {\n    const currentPos = element.scrollTop;\n    const posChange = targetPos - currentPos;\n    const increment = 20;\n\n    console.log('Beginning scrollTo...');\n    console.log('currentPos', currentPos);\n    console.log('posChange', posChange);\n\n    // Quadratic easing (in/out) from http://gizma.com/easing/#quad3 (modified)\n    const easeInOut = (currentTime, start, change, duration) => {\n      console.log('easeInOut()');\n\n      currentTime /= duration / 2;\n\n      if (currentTime < 1) {\n        return change / 2 * currentTime * currentTime + start;\n      }\n\n      currentTime--;\n\n      return -currentTime / 2 * (currentTime * (currentTime - 2) - 1) + start;\n    };\n\n    // Sets up a loop that executes for the length of time set in duration\n    const animateScroll = (elapsedTime) => {\n      elapsedTime += increment;\n\n      console.log('Animating...', elapsedTime);\n\n      const newPos = easeInOut(elapsedTime, currentPos, posChange, duration);\n\n      // Actually sets the document's scroll setting\n      element.scrollTop = newPos;\n      console.log('newPos', newPos);\n\n      if (elapsedTime < duration) {\n        setTimeout(() => { animateScroll(elapsedTime); }, increment);\n      }\n    };\n\n    // Starts the animation\n    animateScroll(0);\n  }\n\n  // Checks for a local link\n  document.addEventListener('click', event => {\n    const target = event.target;\n\n    // Makes sure a link was clicked\n    if (target.tagName.toLowerCase() === 'a' && target.href !== 'undefined') {\n      const href = target.href;\n      const loc = document.location;\n      const currentURL = `${loc.protocol}//${loc.host}${loc.pathname}`;\n\n      // Removes the current URL and checks for a protocol to spot anchor links\n      if (!href.replace(currentURL, '').match(/^http/)) {\n        event.preventDefault();\n\n        const menuAdjustment = size === 'mobile' ? 50 : 60;\n        const anchorOffset = target.offsetTop - menuAdjustment;\n\n        // Animates the scroll to avoid jarring page jumps\n        scrollTo(document.body, anchorOffset, 2000);\n      }\n    }\n  });\n\n  // FOOTNOTE SHUFFLING\n  // I like to keep footnotes below the rest of the content, so this moves 'em.\n  const $mdFootnotesContainer = document.querySelector('.footnotes');\n  if ($mdFootnotesContainer !== null) {\n\n    // Extracts the ordered list full of footnotes\n    const $footnotesList = $mdFootnotesContainer.getElementsByTagName('OL');\n\n    // Targets the preferred footnotes container\n    const $footnotesContainer = document.querySelector('.post-footnotes');\n\n    // Adds a class for styling purposes\n    $footnotesList[0].classList.add('post-footnotes__list');\n\n    // Adds the migrated list to the preferred container\n    $footnotesContainer.appendChild($footnotesList[0]);\n\n    // Now that the footnotes are present, show the container\n    $footnotesContainer.classList.remove('hidden');\n\n    // Removes the old container altogether\n    if ($mdFootnotesContainer.parentNode) {\n      $mdFootnotesContainer.parentNode.removeChild($mdFootnotesContainer);\n    }\n  }\n\n  // GOOGLE ANALYTICS OUTBOUND LINK TRACKING\n  const gaTrackOutboundClick = function(url) {\n    ga('send', 'event', 'outbound', 'click', url, {\n      hitCallback: function() {\n        document.location = url;\n      },\n    });\n  };\n\n  document.addEventListener('click', event => {\n    if (event.target.classList.contains('js__ga-track-outbound')) {\n      event.preventDefault();\n      gaTrackOutboundClick(event.target.href);\n    }\n  });\n\n  // HIGHLIGHTSHARE PLUGIN INIT\n  if (size.length) {\n    const highlightshare = new HighlightShare({\n      via: 'jlengstorf',\n      container: '.main-content__content',\n    });\n  }\n\n})();\n","// Let's build a highlighted text sharing tool!\nfunction HighlightShare(options) {\n  const opts = options || {};\n  const classes = opts.classNames || {};\n  const config = this.config = {\n    url: opts.url || window.location.href, // URL to share\n    hashtags: opts.hashtags || '', // Hashtags (for Twitter)\n    related: opts.related || 'jlengstorf', // Related accounts (for Twitter)\n    via: opts.via || '', // Article author (for Twitter)\n    classNames: {\n      wrapper: classes.wrapper || 'highlight-share__share-box',\n      active: classes.active || 'highlight-share__is-active',\n      tweetBtn: classes.tweetBtn || 'highlight-share__share-btn--twitter',\n    },\n    container: opts.container || 'body',\n    appendTo: 'body', // Query selector (see: http://mzl.la/1AYePlN)\n  };\n  const shareBox = document.createElement('div');\n  const tweetBtn = document.createElement('button');\n  let container;\n\n  // For saving the selection\n  this.savedText = false;\n\n  // So we can avoid collisions\n  this.isActive = false;\n\n  // Twitter button attributes and content\n  tweetBtn.className = config.classNames.tweetBtn;\n\n  // Share box attributes\n  shareBox.className = config.classNames.wrapper;\n  shareBox.appendChild(tweetBtn);\n\n  // Adds a click handler for sharing quotes\n  shareBox.addEventListener('click', this.handleButtonClick.bind(this));\n\n  // Sets the container for restricting functionality to just one section\n  this.container = document.querySelector(this.config.container);\n\n  // Appends the sharing box to the DOM\n  document.querySelector(config.appendTo).appendChild(shareBox);\n\n  // Listens for mouseup as a signal that text selection may have occurred\n  document.addEventListener('mouseup', this.handleSelection.bind(this));\n}\n\nHighlightShare.prototype = Object.create({\n  constructor: {\n    value: HighlightShare,\n  },\n});\n\nHighlightShare.prototype.getSelectedText = function() {\n  if (window.getSelection) {\n    const selection = window.getSelection();\n    if (selection.getRangeAt && selection.rangeCount) {\n      return selection.getRangeAt(0);\n    }\n  } else if (document.selection && document.selection.createRange) {\n    return document.selection.createRange();\n  }\n\n  return false;\n};\n\nHighlightShare.prototype.restoreSelectedText = function(range) {\n  if (range) {\n    if (window.getSelection) {\n      const selection = window.getSelection();\n      selection.removeAllRanges();\n      selection.addRange(range);\n    } else if (document.selection && range.select) {\n      range.select();\n    }\n  }\n};\n\nHighlightShare.prototype.handleSelection = function(event) {\n  this.savedText = this.getSelectedText();\n\n  if (this.isInContainer(event.target)) {\n    setTimeout(this.showSharingBox.bind(this), 100, event);\n  }\n};\n\nHighlightShare.prototype.showSharingBox = function(event) {\n  const isEmpty = this.savedText.toString().length === 0;\n  const wrapper = this.getWrapper();\n  const ignoredTags = ['a', 'img', 'button', 'input', 'select'];\n  const targetTag = event.target.tagName.toLowerCase();\n\n  if (!isEmpty && !this.isActive && ignoredTags.indexOf(targetTag) === -1) {\n    this.isActive = true;\n    wrapper.style.left = event.pageX + 'px';\n    wrapper.style.top = event.pageY + 'px';\n    wrapper.className += ' ' + this.config.classNames.active;\n  } else {\n    this.hideSharingBox();\n  }\n};\n\nHighlightShare.prototype.handleButtonClick = function(event) {\n  if (!this.savedText) {\n    return;\n  }\n\n  if (event.target.className.indexOf(this.config.classNames.tweetBtn) !== -1) {\n    window.open(\n      this.buildTwitterUrl(),\n      'sharing-window',\n      'width=600, height=400, top=200, left=300'\n    );\n  }\n\n  this.restoreSelectedText(this.savedText);\n};\n\nHighlightShare.prototype.hideSharingBox = function() {\n  const wrapper = this.getWrapper();\n  const updatedClass = wrapper.className.replace(this.config.classNames.active, '');\n\n  wrapper.style.left = '';\n  wrapper.style.top = '';\n  wrapper.className = updatedClass;\n\n  // Make sure a new box can be opened\n  this.isActive = false;\n};\n\nHighlightShare.prototype.buildTwitterUrl = function() {\n  const url = 'https://twitter.com/intent/tweet';\n  const properties = {\n    text: this.savedText,\n    url: this.config.url || '',\n    hashtags: this.config.hashtags || '',\n    related: this.config.related || '',\n    via: this.config.via || '',\n  };\n  let queryString = '';\n\n  for (let prop in properties) {\n    if (properties[prop].toString().length > 0) {\n      queryString += queryString.length === 0 ? '?' : '&';\n      queryString += prop + '=' + properties[prop];\n    }\n  }\n\n  return url + queryString;\n};\n\nHighlightShare.prototype.getWrapper = function() {\n  return document.getElementsByClassName(this.config.classNames.wrapper)[0];\n};\n\nHighlightShare.prototype.isInContainer = function(node) {\n  if (this.container === null) {\n    return false;\n  }\n\n  return this.container === node ? false : this.container.contains(node);\n};\n","(() => {\n\n  'use strict';\n\n  // CONTACT FORM\n  const $contact = document.getElementById('contact');\n  if ($contact) {\n\n    // Sets up a handler for sending messages\n    const sendMessage = function(message, callback) {\n\n      // Messages are delivered using Mandrill\n      const endpointURI = 'https://mandrillapp.com/api/1.0/messages/send.json';\n\n      // Creates an XHR object for sending the request\n      const xhr = new XMLHttpRequest();\n\n      // Converts the message object to JSON\n      const messageJSON = JSON.stringify(message);\n\n      xhr.open('POST', endpointURI);\n\n      // Ensures `this` is handled properly\n      xhr.onload = callback.bind(xhr);\n\n      xhr.send(messageJSON);\n    };\n\n    const disableForm = function(form) {\n\n      // Allows for custom styling to be applied to the form\n      form.classList.add('disabled');\n\n      // Prevents additional submissions of the form\n      form.getElementsByTagName('BUTTON')[0].disabled = true;\n    };\n\n    const enableForm = function(form) {\n\n      // Reenables the submit button\n      form.getElementsByTagName('BUTTON')[0].disabled = false;\n\n      // Removes the disabled styling class from the form\n      form.classList.remove('disabled');\n    };\n\n    const displayError = function(form, msg) {\n\n      // Creates new DOM elements to build the error\n      const $error = document.createElement('div');\n      const $errorMsg = document.createElement('p');\n\n      // Adds classes for styling\n      $error.classList.add('opt-in__error');\n      $errorMsg.classList.add('opt-in__error-message');\n\n      // Adds the error message\n      $errorMsg.textContent = msg;\n\n      $error.appendChild($errorMsg);\n      form.insertBefore($error, form.firstChild);\n    };\n\n    const removeAllErrors = function(form) {\n      const $errors = form.querySelectorAll('.opt-in__error');\n\n      [].map.call($errors, error => form.removeChild(error));\n    };\n\n    const validateFields = (form, params) => {\n      let isError = false;\n\n      if (params.message === '') {\n        isError = true;\n        displayError(form, 'Please enter a message.');\n      }\n\n      if (params.email === '') {\n        isError = true;\n        displayError(form, 'Please enter your email.');\n      }\n\n      if (params.fname === '' || params.lname === '') {\n        isError = true;\n        displayError(form, 'Please enter your full name.');\n      }\n\n      // Checks the honeypot for bots\n      if (params.comment !== '') {\n        isError = true;\n        displayError(form, 'You appear to be a robot. Please reload and try again.');\n      }\n\n      return isError;\n    };\n\n    const afterSubmit = xhrEvent => {\n      const xhr = xhrEvent.currentTarget;\n\n      if (xhr.readyState === 4 && xhr.status === 200) {\n        const response = JSON.parse(xhr.responseText)[0];\n\n        if (response.status === 'sent') {\n          const loc = window.location;\n          const baseURL = loc.origin || loc.protocol + '//' + loc.host;\n\n          // Sends the user to a thank you page\n          window.location = baseURL + '/thank-you/';\n        } else {\n\n          // TODO This feels sloppy and fragile\n          const $form = document.getElementById('contact');\n\n          // Lets the user attempt to resubmit the form\n          enableForm($form);\n\n          // If we didn't get a \"sent\" status, something's wrong.\n          const msg = response.reject_reason || 'Please try again. Something went weird.';\n          displayError($form, msg);\n        }\n      }\n    };\n\n    let toSend = {\n      key: null,\n      message: {\n        text: null,\n        subject: 'Message from lengstorf.com',\n        from_email: null,\n        from_name: null,\n        to: [\n          {\n            email: atob('amFzb25AbGVuZ3N0b3JmLmNvbQ=='),\n            name: atob('SmFzb24gTGVuZ3N0b3Jm'),\n            type: 'to',\n          },\n        ],\n      },\n    };\n\n    // Form is JS-only, so this unhides it\n    $contact.classList.remove('opt-in__hidden');\n\n    // Adds an event handler for the submit action\n    $contact.addEventListener('submit', function(event) {\n      event.preventDefault();\n\n      // Starts by removing any previous errors\n      removeAllErrors(this);\n\n      // Filters and simplifies form fields for easier handling\n      let params = {};\n      [].filter.call(this.elements, el => !!el.name)\n        .forEach(el => params[el.name] = el.value);\n\n      // Validates required form fields\n      const isError = validateFields(this, params);\n\n      if (!isError) {\n        disableForm(this);\n\n        toSend.key = params.key;\n        toSend.message.text = params.message;\n        toSend.message.from_email = params.email;\n        toSend.message.from_name = params.fname + ' ' + params.lname;\n\n        sendMessage(toSend, afterSubmit);\n      }\n    });\n  }\n\n})();\n"],"sourceRoot":"/scripts/"}