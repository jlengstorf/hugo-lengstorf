{"version":3,"sources":["main.js","highlightshare.js"],"names":["HighlightShare","options","opts","classes","classNames","config","this","url","window","location","href","hashtags","related","via","wrapper","active","tweetBtn","container","appendTo","shareBox","document","createElement","savedText","isActive","className","appendChild","addEventListener","handleButtonClick","bind","querySelector","handleSelection","prototype","Object","create","constructor","value","getSelectedText","getSelection","selection","getRangeAt","rangeCount","createRange","restoreSelectedText","range","removeAllRanges","addRange","select","event","isInContainer","target","setTimeout","showSharingBox","isEmpty","toString","length","getWrapper","ignoredTags","targetTag","tagName","toLowerCase","indexOf","hideSharingBox","style","left","pageX","top","pageY","open","buildTwitterUrl","updatedClass","replace","properties","text","queryString","prop","getElementsByClassName","node","contains","size","getComputedStyle","body","getPropertyValue","timeSince","Date","now","daysSince","Math","ceil","$daysAbroad","textContent","$subnavToggle","preventDefault","$header","navText","undefined","classList","remove","add","$sharing","querySelectorAll","callback","i","selector","join","$headlines","$headline","headlineImage","dataset","image","backgroundImage","bgSelectors","$bgHeadlines","$bgHeadline","bgImage","$body","bgColor","backgroundColor","bgFade","bgGradient","$mdFootnotesContainer","$footnotesList","getElementsByTagName","$footnotesContainer","parentNode","removeChild","gaTrackOutboundClick","ga","hitCallback","$contact","getElementById","sendMessage","message","endpointURI","xhr","XMLHttpRequest","messageJSON","JSON","stringify","onload","send","disableForm","form","disabled","enableForm","displayError","msg","$error","$errorMsg","insertBefore","firstChild","removeAllErrors","$errors","map","call","error","validateFields","params","isError","email","fname","lname","comment","afterSubmit","xhrEvent","currentTarget","readyState","status","response","parse","responseText","loc","baseURL","origin","protocol","host","$form","reject_reason","toSend","key","subject","from_email","from_name","to","atob","name","type","filter","elements","el","forEach"],"mappings":"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","file":"main-90c048485d.min.js","sourcesContent":["// Porting the site's functionality away from jQuery\n(() => {\n\n  'use strict';\n\n  /*\n   * SCREEN SIZE DETECTION FOR JS VIA CSS\n   * More info on how this works: http://adactio.com/journal/5429/\n   ***************************************************************************/\n  const size = window.getComputedStyle(document.body, ':after')\n              .getPropertyValue('content').replace(/\\W/g, '');\n\n  /*\n   * CUSTOM THEME JS\n   ***************************************************************************/\n\n  // DAYS ON THE ROAD COUNTER\n  const timeSince = Date.now() - Date('2014-12-30T12:00:00');\n  const daysSince = Math.ceil(timeSince / 86400000); // 1000ms x 60s x 60m x 24h\n  const $daysAbroad = document.querySelector('.days-abroad');\n  if ($daysAbroad) {\n    $daysAbroad.textContent = daysSince + ' days';\n  }\n\n  // SUBNAV TOGGLE\n  // Toggles open/close state of the subnav panel\n  const $subnavToggle = document.querySelector('.subnav-toggle');\n  $subnavToggle.addEventListener('click', (event) => {\n\n    event.preventDefault();\n\n    const $header = document.querySelector('.site-header');\n    let navText;\n\n    if ($header.classList.contains('closed')) {\n      $header.classList.remove('closed');\n      $header.classList.add('open');\n\n      navText = 'Less';\n    } else {\n      $header.classList.remove('open');\n\n      navText = 'More';\n\n      setTimeout(() => { $header.classList.add('closed'); }, 500);\n    }\n\n    $subnavToggle.textContent = navText;\n\n  });\n\n  // SHARING POPUPS\n  if (size === 'desktop') {\n    const $sharing = document.querySelectorAll('.main-content__sharing');\n    const callback = event => {\n\n      // Only targets sharing links\n      if (event.target.classList.contains('main-content__sharing-link')) {\n        event.preventDefault();\n\n        // Opens a small named window for standard sharing\n        window.open(\n          event.target.href,\n          'sharing-window',\n          'width=800, height=400, top=200, left=300'\n        );\n      }\n    };\n\n    // Loops through each matched node and attaches a click handler\n    for (let i = 0; i < $sharing.length; i++) {\n      $sharing[i].addEventListener('click', callback);\n    }\n  }\n\n  // FEATURED IMAGE HANDLING\n  // Mobile featured images are handled differently\n\n  // Adds a class that fires up JS-only styles\n  if (size.length) {\n    const selector = [\n      '.main-content__headline',\n      '.main-content__headline--related',\n      '.main-content__headline--single',\n    ].join(',');\n    const $headlines = document.querySelectorAll(selector);\n    let $headline;\n    let headlineImage;\n\n    for (let i = 0; i < $headlines.length; i++) {\n      $headline = $headlines[i];\n      headlineImage = $headline.dataset.image;\n\n      $headline.style.backgroundImage = 'url(' + headlineImage + ')';\n\n      // Adds a class that causes JS-specific styles to render\n      $headline.classList.add('show-image');\n    }\n  }\n\n  // Attaches the background image to the\n  if (size === 'desktop') {\n    const bgSelectors = [\n      '.main-content__headline',\n      '.main-content__headline--single',\n      '.main-content__headline--page',\n    ].join(',');\n    const $bgHeadlines = document.querySelectorAll(bgSelectors);\n\n    if ($bgHeadlines.length > 0) {\n      const $bgHeadline = $bgHeadlines[0];\n      const bgImage = $bgHeadline.dataset.image;\n\n      // Loads the body style info to access the background color\n      const $body = document.querySelector('body');\n      const bgColor = window.getComputedStyle($body).backgroundColor;\n\n      // Creates a gradient color to use in the style declaration\n      let bgFade;\n      if (bgColor.indexOf('rgba') === -1) {\n        bgFade = bgColor.replace(')', ', 0.92)').replace('rgb', 'rgba');\n      } else {\n        bgFade = bgColor;\n      }\n\n      const bgGradient = 'linear-gradient(to bottom, ' + bgFade + ', ' +\n        bgColor + ' 50vw)';\n\n      $body.style.backgroundImage = bgGradient + ', url(' + bgImage + ')';\n    }\n  }\n\n  // FOOTNOTE SHUFFLING\n  // I like to keep footnotes below the rest of the content, so this moves 'em.\n  const $mdFootnotesContainer = document.querySelector('.footnotes');\n  if ($mdFootnotesContainer !== null) {\n\n    // Extracts the ordered list full of footnotes\n    const $footnotesList = $mdFootnotesContainer.getElementsByTagName('OL');\n\n    // Targets the preferred footnotes container\n    const $footnotesContainer = document.querySelector('.post-footnotes');\n\n    // Adds a class for styling purposes\n    $footnotesList[0].classList.add('post-footnotes__list');\n\n    // Adds the migrated list to the preferred container\n    $footnotesContainer.appendChild($footnotesList[0]);\n\n    // Now that the footnotes are present, show the container\n    $footnotesContainer.classList.remove('hidden');\n\n    // Removes the old container altogether\n    if ($mdFootnotesContainer.parentNode) {\n      $mdFootnotesContainer.parentNode.removeChild($mdFootnotesContainer);\n    }\n  }\n\n  // GOOGLE ANALYTICS OUTBOUND LINK TRACKING\n  const gaTrackOutboundClick = function(url) {\n    ga('send', 'event', 'outbound', 'click', url, {\n      hitCallback: function() {\n        document.location = url;\n      },\n    });\n  };\n\n  document.addEventListener('click', event => {\n    if (event.target.classList.contains('js__ga-track-outbound')) {\n      event.preventDefault();\n      gaTrackOutboundClick(event.target.href);\n    }\n  });\n\n  // CONTACT FORM\n  const $contact = document.getElementById('contact');\n  if ($contact) {\n\n    // Sets up a handler for sending messages\n    const sendMessage = function(message, callback) {\n\n      // Messages are delivered using Mandrill\n      const endpointURI = 'https://mandrillapp.com/api/1.0/messages/send.json';\n\n      // Creates an XHR object for sending the request\n      const xhr = new XMLHttpRequest();\n\n      // Converts the message object to JSON\n      const messageJSON = JSON.stringify(message);\n\n      xhr.open('POST', endpointURI);\n\n      // Ensures `this` is handled properly\n      xhr.onload = callback.bind(xhr);\n\n      xhr.send(messageJSON);\n    };\n\n    const disableForm = function(form) {\n\n      // Allows for custom styling to be applied to the form\n      form.classList.add('disabled');\n\n      // Prevents additional submissions of the form\n      form.getElementsByTagName('BUTTON')[0].disabled = true;\n    };\n\n    const enableForm = function(form) {\n\n      // Reenables the submit button\n      form.getElementsByTagName('BUTTON')[0].disabled = false;\n\n      // Removes the disabled styling class from the form\n      form.classList.remove('disabled');\n    };\n\n    const displayError = function(form, msg) {\n\n      // Creates new DOM elements to build the error\n      const $error = document.createElement('div');\n      const $errorMsg = document.createElement('p');\n\n      // Adds classes for styling\n      $error.classList.add('opt-in__error');\n      $errorMsg.classList.add('opt-in__error-message');\n\n      // Adds the error message\n      $errorMsg.textContent = msg;\n\n      $error.appendChild($errorMsg);\n      form.insertBefore($error, form.firstChild);\n    };\n\n    const removeAllErrors = function(form) {\n      const $errors = form.querySelectorAll('.opt-in__error');\n\n      [].map.call($errors, error => form.removeChild(error));\n    };\n\n    const validateFields = (form, params) => {\n      let isError = false;\n\n      if (params.message === '') {\n        isError = true;\n        displayError(form, 'Please enter a message.');\n      }\n\n      if (params.email === '') {\n        isError = true;\n        displayError(form, 'Please enter your email.');\n      }\n\n      if (params.fname === '' || params.lname === '') {\n        isError = true;\n        displayError(form, 'Please enter your full name.');\n      }\n\n      // Checks the honeypot for bots\n      if (params.comment !== '') {\n        isError = true;\n        displayError(form, 'You appear to be a robot. Please reload and try again.');\n      }\n\n      return isError;\n    };\n\n    const afterSubmit = xhrEvent => {\n      const xhr = xhrEvent.currentTarget;\n\n      if (xhr.readyState === 4 && xhr.status === 200) {\n        const response = JSON.parse(xhr.responseText)[0];\n\n        if (response.status === 'sent') {\n          const loc = window.location;\n          const baseURL = loc.origin || loc.protocol + '//' + loc.host;\n\n          // Sends the user to a thank you page\n          window.location = baseURL + '/thank-you/';\n        } else {\n\n          // TODO This feels sloppy and fragile\n          const $form = document.getElementById('contact');\n\n          // Lets the user attempt to resubmit the form\n          enableForm($form);\n\n          // If we didn't get a \"sent\" status, something's wrong.\n          const msg = response.reject_reason || 'Please try again. Something went weird.';\n          displayError($form, msg);\n        }\n      }\n    };\n\n    let toSend = {\n      key: null,\n      message: {\n        text: null,\n        subject: 'Message from lengstorf.com',\n        from_email: null,\n        from_name: null,\n        to: [\n          {\n            email: atob('amFzb25AbGVuZ3N0b3JmLmNvbQ=='),\n            name: atob('SmFzb24gTGVuZ3N0b3Jm'),\n            type: 'to',\n          },\n        ],\n      },\n    };\n\n    // Form is JS-only, so this unhides it\n    $contact.classList.remove('opt-in__hidden');\n\n    // Adds an event handler for the submit action\n    $contact.addEventListener('submit', function(event) {\n      event.preventDefault();\n\n      // Starts by removing any previous errors\n      removeAllErrors(this);\n\n      // Filters and simplifies form fields for easier handling\n      let params = {};\n      [].filter.call(this.elements, el => !!el.name)\n        .forEach(el => params[el.name] = el.value);\n\n      // Validates required form fields\n      const isError = validateFields(this, params);\n\n      if (!isError) {\n        disableForm(this);\n\n        toSend.key = params.key;\n        toSend.message.text = params.message;\n        toSend.message.from_email = params.email;\n        toSend.message.from_name = params.fname + ' ' + params.lname;\n\n        sendMessage(toSend, afterSubmit);\n      }\n    });\n  }\n\n  // {\n  //     \"key\": \"ztJWhFuV1KvoxLr1nPW5ZQ\",\n  //     \"message\": {\n  //         \"text\": \"This is a test\",\n  //         \"subject\": \"Mandrill Testing\",\n  //         \"from_email\": \"testing@example.com\",\n  //         \"from_name\": \"Example Name\",\n  //         \"to\": [\n  //             {\n  //                 \"email\": \"jason@lengstorf.com\",\n  //                 \"name\": \"Jason Lengstorf\",\n  //                 \"type\": \"to\"\n  //             }\n  //         ]\n  //     }\n  // }\n\n  // HIGHLIGHTSHARE PLUGIN\n  if (size.length) {\n    const highlightshare = new HighlightShare({\n      via: 'jlengstorf',\n      container: '.main-content__content',\n    });\n  }\n\n})();\n","// Let's build a highlighted text sharing tool!\nfunction HighlightShare(options) {\n  const opts = options || {};\n  const classes = opts.classNames || {};\n  const config = this.config = {\n    url: opts.url || window.location.href, // URL to share\n    hashtags: opts.hashtags || '', // Hashtags (for Twitter)\n    related: opts.related || 'jlengstorf', // Related accounts (for Twitter)\n    via: opts.via || '', // Article author (for Twitter)\n    classNames: {\n      wrapper: classes.wrapper || 'highlight-share__share-box',\n      active: classes.active || 'highlight-share__is-active',\n      tweetBtn: classes.tweetBtn || 'highlight-share__share-btn--twitter',\n    },\n    container: opts.container || 'body',\n    appendTo: 'body', // Query selector (see: http://mzl.la/1AYePlN)\n  };\n  const shareBox = document.createElement('div');\n  const tweetBtn = document.createElement('button');\n  let container;\n\n  // For saving the selection\n  this.savedText = false;\n\n  // So we can avoid collisions\n  this.isActive = false;\n\n  // Twitter button attributes and content\n  tweetBtn.className = config.classNames.tweetBtn;\n\n  // Share box attributes\n  shareBox.className = config.classNames.wrapper;\n  shareBox.appendChild(tweetBtn);\n\n  // Adds a click handler for sharing quotes\n  shareBox.addEventListener('click', this.handleButtonClick.bind(this));\n\n  // Sets the container for restricting functionality to just one section\n  this.container = document.querySelector(this.config.container);\n\n  // Appends the sharing box to the DOM\n  document.querySelector(config.appendTo).appendChild(shareBox);\n\n  // Listens for mouseup as a signal that text selection may have occurred\n  document.addEventListener('mouseup', this.handleSelection.bind(this));\n}\n\nHighlightShare.prototype = Object.create({\n  constructor: {\n    value: HighlightShare,\n  },\n});\n\nHighlightShare.prototype.getSelectedText = function() {\n  if (window.getSelection) {\n    const selection = window.getSelection();\n    if (selection.getRangeAt && selection.rangeCount) {\n      return selection.getRangeAt(0);\n    }\n  } else if (document.selection && document.selection.createRange) {\n    return document.selection.createRange();\n  }\n\n  return false;\n};\n\nHighlightShare.prototype.restoreSelectedText = function(range) {\n  if (range) {\n    if (window.getSelection) {\n      const selection = window.getSelection();\n      selection.removeAllRanges();\n      selection.addRange(range);\n    } else if (document.selection && range.select) {\n      range.select();\n    }\n  }\n};\n\nHighlightShare.prototype.handleSelection = function(event) {\n  this.savedText = this.getSelectedText();\n\n  if (this.isInContainer(event.target)) {\n    setTimeout(this.showSharingBox.bind(this), 100, event);\n  }\n};\n\nHighlightShare.prototype.showSharingBox = function(event) {\n  const isEmpty = this.savedText.toString().length === 0;\n  const wrapper = this.getWrapper();\n  const ignoredTags = ['a', 'img', 'button', 'input', 'select'];\n  const targetTag = event.target.tagName.toLowerCase();\n\n  if (!isEmpty && !this.isActive && ignoredTags.indexOf(targetTag) === -1) {\n    this.isActive = true;\n    wrapper.style.left = event.pageX + 'px';\n    wrapper.style.top = event.pageY + 'px';\n    wrapper.className += ' ' + this.config.classNames.active;\n  } else {\n    this.hideSharingBox();\n  }\n};\n\nHighlightShare.prototype.handleButtonClick = function(event) {\n  if (!this.savedText) {\n    return;\n  }\n\n  if (event.target.className.indexOf(this.config.classNames.tweetBtn) !== -1) {\n    window.open(\n      this.buildTwitterUrl(),\n      'sharing-window',\n      'width=600, height=400, top=200, left=300'\n    );\n  }\n\n  this.restoreSelectedText(this.savedText);\n};\n\nHighlightShare.prototype.hideSharingBox = function() {\n  const wrapper = this.getWrapper();\n  const updatedClass = wrapper.className.replace(this.config.classNames.active, '');\n\n  wrapper.style.left = '';\n  wrapper.style.top = '';\n  wrapper.className = updatedClass;\n\n  // Make sure a new box can be opened\n  this.isActive = false;\n};\n\nHighlightShare.prototype.buildTwitterUrl = function() {\n  const url = 'https://twitter.com/intent/tweet';\n  const properties = {\n    text: this.savedText,\n    url: this.config.url || '',\n    hashtags: this.config.hashtags || '',\n    related: this.config.related || '',\n    via: this.config.via || '',\n  };\n  let queryString = '';\n\n  for (let prop in properties) {\n    if (properties[prop].toString().length > 0) {\n      queryString += queryString.length === 0 ? '?' : '&';\n      queryString += prop + '=' + properties[prop];\n    }\n  }\n\n  return url + queryString;\n};\n\nHighlightShare.prototype.getWrapper = function() {\n  return document.getElementsByClassName(this.config.classNames.wrapper)[0];\n};\n\nHighlightShare.prototype.isInContainer = function(node) {\n  if (this.container === null) {\n    return false;\n  }\n\n  return this.container === node ? false : this.container.contains(node);\n};\n"],"sourceRoot":"/scripts/"}