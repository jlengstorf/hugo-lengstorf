{"version":3,"sources":["main.js","highlightshare.js","five-stages.js","mandrillcontactform.js"],"names":["HighlightShare","options","opts","classes","classNames","config","this","url","window","location","href","hashtags","related","via","wrapper","active","tweetBtn","container","appendTo","shareBox","document","createElement","savedText","isActive","className","appendChild","addEventListener","handleButtonClick","bind","querySelector","handleSelection","$fiveStages","querySelectorAll","onVisibilityChange","el","callback","isElementInViewport","classList","add","remove","position","getBoundingClientRect","top","left","bottom","innerHeight","documentElement","clientHeight","right","innerWidth","clientWidth","forEach","call","viewportChangeHandler","prototype","Object","create","constructor","value","getSelectedText","getSelection","selection","getRangeAt","rangeCount","createRange","restoreSelectedText","range","removeAllRanges","addRange","select","event","isInContainer","target","setTimeout","showSharingBox","isEmpty","toString","length","getWrapper","ignoredTags","targetTag","tagName","toLowerCase","indexOf","hideSharingBox","style","pageX","pageY","open","buildTwitterUrl","updatedClass","replace","properties","text","queryString","prop","getElementsByClassName","node","contains","scrollTo","element","targetPos","duration","Promise","resolve","reject","currentPos","scrollTop","posChange","increment","easeInOut","elapsed","start","change","animateScroll","elapsedTime","newPos","findLocalLinksAndScroll","newURL","isScrolling","targetID","split","loc","currentURL","protocol","host","pathname","console","log","match","preventDefault","scrollTarget","getElementById","menuAdjustment","size","anchorOffset","offsetTop","offsetParent","isDocBody","body","doc","then","getComputedStyle","getPropertyValue","todayIs","Date","now","iLeftOn","daysSince","Math","ceil","$daysAbroad","textContent","$subnavToggle","$header","navText","undefined","$sharing","i","selector","join","$headlines","$headline","headlineImage","dataset","image","backgroundImage","bgSelectors","$bgHeadlines","$bgHeadline","bgImage","$body","bgColor","backgroundColor","bgFade","bgGradient","history","pushState","$mdFootnotesContainer","$footnotesList","getElementsByTagName","$footnotesContainer","parentNode","removeChild","gaTrackOutboundClick","ga","hitCallback","$contact","sendMessage","message","endpointURI","xhr","XMLHttpRequest","messageJSON","JSON","stringify","onload","send","disableForm","form","disabled","enableForm","displayError","msg","$error","$errorMsg","insertBefore","firstChild","removeAllErrors","$errors","map","error","validateFields","params","isError","email","fname","lname","comment","afterSubmit","xhrEvent","currentTarget","readyState","status","response","parse","responseText","baseURL","origin","$form","reject_reason","toSend","key","subject","from_email","from_name","to","atob","name","type","filter","elements"],"mappings":"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","file":"main-086eaef022.min.js","sourcesContent":["// Porting the site's functionality away from jQuery\n(() => {\n\n  'use strict';\n\n  /*\n   * SCREEN SIZE DETECTION FOR JS VIA CSS\n   * More info on how this works: http://adactio.com/journal/5429/\n   ***************************************************************************/\n  const size = window.getComputedStyle(document.body, ':after')\n              .getPropertyValue('content').replace(/\\W/g, '');\n\n  /*\n   * CUSTOM THEME JS\n   ***************************************************************************/\n\n  // DAYS ON THE ROAD COUNTER\n  const todayIs = Date.now();\n  const iLeftOn = new Date('2014-12-30T12:00:00');\n\n  // 1000ms x 60s x 60m x 24h\n  const daysSince = Math.ceil((todayIs - iLeftOn) / 86400000);\n  const $daysAbroad = document.querySelector('.days-abroad');\n  if ($daysAbroad) {\n    $daysAbroad.textContent = daysSince + ' days';\n  }\n\n  // SUBNAV TOGGLE\n  // Toggles open/close state of the subnav panel\n  const $subnavToggle = document.querySelector('.subnav-toggle');\n  $subnavToggle.addEventListener('click', (event) => {\n\n    event.preventDefault();\n\n    const $header = document.querySelector('.site-header');\n    let navText;\n\n    if ($header.classList.contains('closed')) {\n      $header.classList.remove('closed');\n      $header.classList.add('open');\n\n      navText = 'Less';\n    } else {\n      $header.classList.remove('open');\n\n      navText = 'More';\n\n      setTimeout(() => { $header.classList.add('closed'); }, 500);\n    }\n\n    $subnavToggle.textContent = navText;\n\n  });\n\n  // SHARING POPUPS\n  if (size === 'desktop') {\n    const $sharing = document.querySelectorAll('.main-content__sharing');\n    const callback = event => {\n\n      // Only targets sharing links\n      if (event.target.classList.contains('main-content__sharing-link')) {\n        event.preventDefault();\n\n        // Opens a small named window for standard sharing\n        window.open(\n          event.target.href,\n          'sharing-window',\n          'width=800, height=400, top=200, left=300'\n        );\n      }\n    };\n\n    // Loops through each matched node and attaches a click handler\n    for (let i = 0; i < $sharing.length; i++) {\n      $sharing[i].addEventListener('click', callback);\n    }\n  }\n\n  // FEATURED IMAGE HANDLING\n  // Mobile featured images are handled differently\n\n  // Adds a class that fires up JS-only styles\n  if (size.length) {\n    const selector = [\n      '.main-content__headline',\n      '.main-content__headline--related',\n      '.main-content__headline--single',\n    ].join(',');\n    const $headlines = document.querySelectorAll(selector);\n    let $headline;\n    let headlineImage;\n\n    for (let i = 0; i < $headlines.length; i++) {\n      $headline = $headlines[i];\n      headlineImage = $headline.dataset.image;\n\n      $headline.style.backgroundImage = 'url(' + headlineImage + ')';\n\n      // Adds a class that causes JS-specific styles to render\n      $headline.classList.add('show-image');\n    }\n  }\n\n  // Attaches the background image to the\n  if (size === 'desktop') {\n    const bgSelectors = [\n      '.main-content__headline',\n      '.main-content__headline--single',\n      '.main-content__headline--page',\n    ].join(',');\n    const $bgHeadlines = document.querySelectorAll(bgSelectors);\n\n    if ($bgHeadlines.length > 0) {\n      const $bgHeadline = $bgHeadlines[0];\n      const bgImage = $bgHeadline.dataset.image;\n\n      // Loads the body style info to access the background color\n      const $body = document.querySelector('body');\n      const bgColor = window.getComputedStyle($body).backgroundColor;\n\n      // Creates a gradient color to use in the style declaration\n      let bgFade;\n      if (bgColor.indexOf('rgba') === -1) {\n        bgFade = bgColor.replace(')', ', 0.92)').replace('rgb', 'rgba');\n      } else {\n        bgFade = bgColor;\n      }\n\n      const bgGradient = 'linear-gradient(to bottom, ' + bgFade + ', ' +\n        bgColor + ' 50vw)';\n\n      $body.style.backgroundImage = bgGradient + ', url(' + bgImage + ')';\n    }\n  }\n\n  // LOCAL SCROLLING (WITHOUT JQUERY)\n  // Adds a function to handle scrolling the page\n  function scrollTo(element, targetPos, duration) {\n    return new Promise((resolve, reject) => {\n      const currentPos = element.scrollTop;\n      const posChange = targetPos - currentPos;\n      const increment = 20;\n\n      // Quadratic easing (in/out) from http://gizma.com/easing/#quad3 (modified)\n      const easeInOut = (elapsed, start, change, length) => {\n        elapsed /= length / 2;\n\n        if (elapsed < 1) {\n          return change / 2 * elapsed * elapsed + start;\n        }\n\n        elapsed--;\n\n        return -change / 2 * (elapsed * (elapsed - 2) - 1) + start;\n      };\n\n      // Sets up a loop that executes for the length of time set in duration\n      const animateScroll = (elapsedTime) => {\n        elapsedTime += increment;\n\n        const newPos = easeInOut(elapsedTime, currentPos, posChange, duration);\n\n        // Actually sets the document's scroll setting\n        element.scrollTop = newPos;\n\n        if (elapsedTime < duration) {\n          setTimeout(() => { animateScroll(elapsedTime); }, increment);\n        } else {\n          resolve();\n        }\n      };\n\n      // Starts the animation\n      animateScroll(0);\n    });\n  }\n\n  function findLocalLinksAndScroll(newURL) {\n    return new Promise((resolve, reject) => {\n\n      // Only runs if there's no current scrolling happening\n      if (isScrolling) {\n        return;\n      }\n\n      // Prevents overlapping calls\n      isScrolling = true;\n\n      const targetID = newURL.split('#')[1] || false;\n      const loc = document.location;\n      const currentURL = `${loc.protocol}//${loc.host}${loc.pathname}`;\n\n      console.log(targetID);\n\n      // Removes the current URL and checks for a protocol to spot anchor links\n      if (!newURL.replace(currentURL, '').match(/^http/) && !!targetID) {\n        event.preventDefault();\n\n        const scrollTarget = document.getElementById(targetID);\n        const menuAdjustment = size === 'mobile' ? 60 : 70;\n        let anchorOffset = scrollTarget.offsetTop - menuAdjustment;\n\n        if (scrollTarget.offsetParent.classList.contains('post-footnotes')) {\n\n          // When we moved the footnotes, the offsetTop amount broke.\n          // We use the parent to fix that, plus remove the 30px of padding.\n          anchorOffset += scrollTarget.offsetParent.offsetTop + 30;\n        }\n\n        // Works around inconsistencies between Chrome & Firefox\n        const isDocBody = document.body.scrollTop;\n        const doc = isDocBody ? document.body : document.documentElement;\n\n        // Animates the scroll to avoid jarring page jumps\n        scrollTo(doc, anchorOffset, 750)\n          .then(() => {\n            isScrolling = false;\n            resolve();\n          });\n      }\n    });\n  }\n\n  // Gives us a state to track\n  let isScrolling = false;\n\n  // Handles clicking links inside the page\n  document.addEventListener('click', (event) => {\n    const target = event.target;\n\n    // Makes sure a link was clicked\n    if (target.tagName.toLowerCase() === 'a' && target.href !== 'undefined') {\n      const newURL = target.href;\n\n      findLocalLinksAndScroll(newURL)\n        .then(() => {\n          history.pushState({ newURL: newURL }, '', newURL);\n        });\n    }\n  });\n\n  // Handles the back button\n  window.addEventListener('hashchange', (event) => {\n    event.preventDefault();\n\n    const newURL = event.newURL;\n\n    findLocalLinksAndScroll(newURL);\n  });\n\n  // FOOTNOTE SHUFFLING\n  // I like to keep footnotes below the rest of the content, so this moves 'em.\n  const $mdFootnotesContainer = document.querySelector('.footnotes');\n  if ($mdFootnotesContainer !== null) {\n\n    // Extracts the ordered list full of footnotes\n    const $footnotesList = $mdFootnotesContainer.getElementsByTagName('OL');\n\n    // Targets the preferred footnotes container\n    const $footnotesContainer = document.querySelector('.post-footnotes');\n\n    // Adds a class for styling purposes\n    $footnotesList[0].classList.add('post-footnotes__list');\n\n    // Adds the migrated list to the preferred container\n    $footnotesContainer.appendChild($footnotesList[0]);\n\n    // Now that the footnotes are present, show the container\n    $footnotesContainer.classList.remove('hidden');\n\n    // Removes the old container altogether\n    if ($mdFootnotesContainer.parentNode) {\n      $mdFootnotesContainer.parentNode.removeChild($mdFootnotesContainer);\n    }\n  }\n\n  // GOOGLE ANALYTICS OUTBOUND LINK TRACKING\n  const gaTrackOutboundClick = function(url) {\n    ga('send', 'event', 'outbound', 'click', url, {\n      hitCallback: function() {\n        document.location = url;\n      },\n    });\n  };\n\n  document.addEventListener('click', event => {\n    if (event.target.classList.contains('js__ga-track-outbound')) {\n      event.preventDefault();\n      gaTrackOutboundClick(event.target.href);\n    }\n  });\n\n  // HIGHLIGHTSHARE PLUGIN INIT\n  if (size.length) {\n    const highlightshare = new HighlightShare({\n      via: 'jlengstorf',\n      container: '.main-content__content',\n    });\n  }\n\n})();\n","// Let's build a highlighted text sharing tool!\nfunction HighlightShare(options) {\n  const opts = options || {};\n  const classes = opts.classNames || {};\n  const config = this.config = {\n    url: opts.url || window.location.href, // URL to share\n    hashtags: opts.hashtags || '', // Hashtags (for Twitter)\n    related: opts.related || 'jlengstorf', // Related accounts (for Twitter)\n    via: opts.via || '', // Article author (for Twitter)\n    classNames: {\n      wrapper: classes.wrapper || 'highlight-share__share-box',\n      active: classes.active || 'highlight-share__is-active',\n      tweetBtn: classes.tweetBtn || 'highlight-share__share-btn--twitter',\n    },\n    container: opts.container || 'body',\n    appendTo: 'body', // Query selector (see: http://mzl.la/1AYePlN)\n  };\n  const shareBox = document.createElement('div');\n  const tweetBtn = document.createElement('button');\n  let container;\n\n  // For saving the selection\n  this.savedText = false;\n\n  // So we can avoid collisions\n  this.isActive = false;\n\n  // Twitter button attributes and content\n  tweetBtn.className = config.classNames.tweetBtn;\n\n  // Share box attributes\n  shareBox.className = config.classNames.wrapper;\n  shareBox.appendChild(tweetBtn);\n\n  // Adds a click handler for sharing quotes\n  shareBox.addEventListener('click', this.handleButtonClick.bind(this));\n\n  // Sets the container for restricting functionality to just one section\n  this.container = document.querySelector(this.config.container);\n\n  // Appends the sharing box to the DOM\n  document.querySelector(config.appendTo).appendChild(shareBox);\n\n  // Listens for mouseup as a signal that text selection may have occurred\n  document.addEventListener('mouseup', this.handleSelection.bind(this));\n}\n\nHighlightShare.prototype = Object.create({\n  constructor: {\n    value: HighlightShare,\n  },\n});\n\nHighlightShare.prototype.getSelectedText = function() {\n  if (window.getSelection) {\n    const selection = window.getSelection();\n    if (selection.getRangeAt && selection.rangeCount) {\n      return selection.getRangeAt(0);\n    }\n  } else if (document.selection && document.selection.createRange) {\n    return document.selection.createRange();\n  }\n\n  return false;\n};\n\nHighlightShare.prototype.restoreSelectedText = function(range) {\n  if (range) {\n    if (window.getSelection) {\n      const selection = window.getSelection();\n      selection.removeAllRanges();\n      selection.addRange(range);\n    } else if (document.selection && range.select) {\n      range.select();\n    }\n  }\n};\n\nHighlightShare.prototype.handleSelection = function(event) {\n  this.savedText = this.getSelectedText();\n\n  if (this.isInContainer(event.target)) {\n    setTimeout(this.showSharingBox.bind(this), 100, event);\n  }\n};\n\nHighlightShare.prototype.showSharingBox = function(event) {\n  const isEmpty = this.savedText.toString().length === 0;\n  const wrapper = this.getWrapper();\n  const ignoredTags = ['a', 'img', 'button', 'input', 'select'];\n  const targetTag = event.target.tagName.toLowerCase();\n\n  if (!isEmpty && !this.isActive && ignoredTags.indexOf(targetTag) === -1) {\n    this.isActive = true;\n    wrapper.style.left = event.pageX + 'px';\n    wrapper.style.top = event.pageY + 'px';\n    wrapper.className += ' ' + this.config.classNames.active;\n  } else {\n    this.hideSharingBox();\n  }\n};\n\nHighlightShare.prototype.handleButtonClick = function(event) {\n  if (!this.savedText) {\n    return;\n  }\n\n  if (event.target.className.indexOf(this.config.classNames.tweetBtn) !== -1) {\n    window.open(\n      this.buildTwitterUrl(),\n      'sharing-window',\n      'width=600, height=400, top=200, left=300'\n    );\n  }\n\n  this.restoreSelectedText(this.savedText);\n};\n\nHighlightShare.prototype.hideSharingBox = function() {\n  const wrapper = this.getWrapper();\n  const updatedClass = wrapper.className.replace(this.config.classNames.active, '');\n\n  wrapper.style.left = '';\n  wrapper.style.top = '';\n  wrapper.className = updatedClass;\n\n  // Make sure a new box can be opened\n  this.isActive = false;\n};\n\nHighlightShare.prototype.buildTwitterUrl = function() {\n  const url = 'https://twitter.com/intent/tweet';\n  const properties = {\n    text: this.savedText,\n    url: this.config.url || '',\n    hashtags: this.config.hashtags || '',\n    related: this.config.related || '',\n    via: this.config.via || '',\n  };\n  let queryString = '';\n\n  for (let prop in properties) {\n    if (properties[prop].toString().length > 0) {\n      queryString += queryString.length === 0 ? '?' : '&';\n      queryString += prop + '=' + properties[prop];\n    }\n  }\n\n  return url + queryString;\n};\n\nHighlightShare.prototype.getWrapper = function() {\n  return document.getElementsByClassName(this.config.classNames.wrapper)[0];\n};\n\nHighlightShare.prototype.isInContainer = function(node) {\n  if (this.container === null) {\n    return false;\n  }\n\n  return this.container === node ? false : this.container.contains(node);\n};\n","(() => {\n  'use strict';\n\n  const $fiveStages = document.querySelectorAll('.five-stages');\n\n  if ($fiveStages) {\n\n    // Sets up a check to determine whether or not the element is on-screen\n    [].forEach.call($fiveStages, el => {\n\n      // Adds a class to the element so we know JS is working\n      el.classList.add('js__active');\n\n      // Sets up a handler and attaches it to the scroll event\n      const viewportChangeHandler = onVisibilityChange(el);\n      addEventListener('scroll', viewportChangeHandler, false);\n    });\n\n    // Adds a class to on-screen elements\n    function onVisibilityChange(el, callback) {\n      return function () {\n        if (isElementInViewport(el)) {\n          el.classList.add('js__in-viewport');\n        } else {\n          el.classList.remove('js__in-viewport');\n        }\n      }\n    }\n\n    // Helper for checking if the element is within the viewport\n    // @see http://stackoverflow.com/a/7557433/463471\n    function isElementInViewport(el) {\n      const position = el.getBoundingClientRect();\n\n      return (\n        position.top >= 0 &&\n        position.left >= 0 &&\n        position.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n        position.right <= (window.innerWidth || document.documentElement.clientWidth)\n      );\n    }\n  }\n\n})();\n","(() => {\n\n  'use strict';\n\n  // jscs:disable requireCamelCaseOrUpperCaseIdentifiers\n\n  // CONTACT FORM\n  const $contact = document.getElementById('contact');\n  if ($contact) {\n\n    // Sets up a handler for sending messages\n    const sendMessage = function(message, callback) {\n\n      // Messages are delivered using Mandrill\n      const endpointURI = 'https://mandrillapp.com/api/1.0/messages/send.json';\n\n      // Creates an XHR object for sending the request\n      const xhr = new XMLHttpRequest();\n\n      // Converts the message object to JSON\n      const messageJSON = JSON.stringify(message);\n\n      xhr.open('POST', endpointURI);\n\n      // Ensures `this` is handled properly\n      xhr.onload = callback.bind(xhr);\n\n      xhr.send(messageJSON);\n    };\n\n    const disableForm = function(form) {\n\n      // Allows for custom styling to be applied to the form\n      form.classList.add('disabled');\n\n      // Prevents additional submissions of the form\n      form.getElementsByTagName('BUTTON')[0].disabled = true;\n    };\n\n    const enableForm = function(form) {\n\n      // Reenables the submit button\n      form.getElementsByTagName('BUTTON')[0].disabled = false;\n\n      // Removes the disabled styling class from the form\n      form.classList.remove('disabled');\n    };\n\n    const displayError = function(form, msg) {\n\n      // Creates new DOM elements to build the error\n      const $error = document.createElement('div');\n      const $errorMsg = document.createElement('p');\n\n      // Adds classes for styling\n      $error.classList.add('opt-in__error');\n      $errorMsg.classList.add('opt-in__error-message');\n\n      // Adds the error message\n      $errorMsg.textContent = msg;\n\n      $error.appendChild($errorMsg);\n      form.insertBefore($error, form.firstChild);\n    };\n\n    const removeAllErrors = function(form) {\n      const $errors = form.querySelectorAll('.opt-in__error');\n\n      [].map.call($errors, error => form.removeChild(error));\n    };\n\n    const validateFields = (form, params) => {\n      let isError = false;\n\n      if (params.message === '') {\n        isError = true;\n        displayError(form, 'Please enter a message.');\n      }\n\n      if (params.email === '') {\n        isError = true;\n        displayError(form, 'Please enter your email.');\n      }\n\n      if (params.fname === '' || params.lname === '') {\n        isError = true;\n        displayError(form, 'Please enter your full name.');\n      }\n\n      // Checks the honeypot for bots\n      if (params.comment !== '') {\n        isError = true;\n        displayError(form, 'You appear to be a robot. Please reload and try again.');\n      }\n\n      return isError;\n    };\n\n    const afterSubmit = xhrEvent => {\n      const xhr = xhrEvent.currentTarget;\n\n      if (xhr.readyState === 4 && xhr.status === 200) {\n        const response = JSON.parse(xhr.responseText)[0];\n\n        if (response.status === 'sent') {\n          const loc = window.location;\n          const baseURL = loc.origin || loc.protocol + '//' + loc.host;\n\n          // Sends the user to a thank you page\n          window.location = baseURL + '/thank-you/';\n        } else {\n\n          // TODO This feels sloppy and fragile\n          const $form = document.getElementById('contact');\n\n          // Lets the user attempt to resubmit the form\n          enableForm($form);\n\n          // If we didn't get a \"sent\" status, something's wrong.\n          const msg = response.reject_reason || 'Please try again. Something went weird.';\n          displayError($form, msg);\n        }\n      }\n    };\n\n    let toSend = {\n      key: null,\n      message: {\n        text: null,\n        subject: 'Message from lengstorf.com',\n        from_email: null,\n        from_name: null,\n        to: [\n          {\n            email: atob('amFzb25AbGVuZ3N0b3JmLmNvbQ=='),\n            name: atob('SmFzb24gTGVuZ3N0b3Jm'),\n            type: 'to',\n          },\n        ],\n      },\n    };\n\n    // Form is JS-only, so this unhides it\n    $contact.classList.remove('opt-in__hidden');\n\n    // Adds an event handler for the submit action\n    $contact.addEventListener('submit', function(event) {\n      event.preventDefault();\n\n      // Starts by removing any previous errors\n      removeAllErrors(this);\n\n      // Filters and simplifies form fields for easier handling\n      let params = {};\n      [].filter.call(this.elements, el => !!el.name)\n        .forEach(el => params[el.name] = el.value);\n\n      // Validates required form fields\n      const isError = validateFields(this, params);\n\n      if (!isError) {\n        disableForm(this);\n\n        toSend.key = params.key;\n        toSend.message.text = params.message;\n        toSend.message.from_email = params.email;\n        toSend.message.from_name = params.fname + ' ' + params.lname;\n\n        sendMessage(toSend, afterSubmit);\n      }\n    });\n  }\n\n})();\n"],"sourceRoot":"/scripts/"}